<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<link rel="stylesheet" href="./css/1.12.x/jquery-ui.css">
<link rel="stylesheet" href="./css/style.css">
</head>
<body>
	<h1>某コマンドでエフェクトを実行しよう！</h1>
	<div>
		<img id="effect" src="./img/image.jpg">
	</div>
	<div>
		<p>某コマンドを実行してください。</p>
		<p id="console">
			<span>↑</span><span>↑</span><span>↓</span><span>↓</span><span>左</span><span>右</span><span>左</span><span>右</span><span>B</span><span>A</span>
		</p>
	</div>

	<script src="./js/1.12.x/jquery-1.12.4.js"></script>
	<script src="./js/1.12.x/jquery-ui.js"></script>
	<script type="text/javascript">
		// 押されたキーを記憶
		var input = [];
		// 有効なコマンドを定義
		var command = [ 38, 38, 40, 40, 37, 39, 37, 39, 66, 65 ];
		// コマンド実行を成功した回数
		var successCount = 0;

		// キーボードの監視
		$(window).keyup(
				function(e) {
					// 押されたキーを保存
					input.push(e.keyCode);

					// 定義されたコマンドの順で押されているかを確認
					if (command.toString().indexOf(input) !== 0) {
						input = [];
						successCount = 0;
						$("#console span").removeClass('success');
					} else {
						successCount++;
						$("#console span:nth-child(" + successCount + ")")
								.addClass('success');
					}

					// 定義されているコマンドの通り押されたらエフェクトを実行
					if (input.toString().indexOf(command) === 0) {
						// エフェクト実行
						$("#effect").toggle("explode", [], 500, function() {
							$("#effect").toggle("explode", [], 500, function() {
								input = [];
								successCount = 0;
								$("#console span").removeClass('success');
							})
						});
					}
				});
	</script>
</body>
</html>
